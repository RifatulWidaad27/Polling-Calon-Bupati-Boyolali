/* kineo-tech-task, built Sun Jan 08 2017 22:44:06 */

this.JST=this.JST||{},this.JST.ResultsList=Handlebars.template({1:function(a,b,c,d){var e;return null!=(e=b.each.call(a,null!=a?a.models:a,{name:"each",hash:{},fn:this.program(2,d,0),inverse:this.noop,data:d}))?e:""},2:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'\t\t\t\t<option value="'+g(f(null!=(e=null!=a?a.attributes:a)?e.constituency_id:e,a))+'">'+g(f(null!=(e=null!=a?a.attributes:a)?e.constituency:e,a))+"</option>\n"},4:function(a,b,c,d){var e;return null!=(e=b.each.call(a,null!=a?a.models:a,{name:"each",hash:{},fn:this.program(5,d,0),inverse:this.noop,data:d}))?e:""},5:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return"\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t"+g(f(null!=(e=null!=a?a.attributes:a)?e.name:e,a))+"\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t"+g(f(null!=(e=null!=a?a.attributes:a)?e.party:e,a))+"\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t"+g(f(null!=(e=null!=a?a.attributes:a)?e.constituency:e,a))+"\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t"+g(f(null!=(e=null!=a?a.attributes:a)?e.count:e,a))+"\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<ol class="breadcrumb">\n\t<li><a href="/#">Kineo Technical Task</a></li>\n\t<li><a href="/#results">Results</a></li>\n\t<li class="active">Index</li>\n</ol>\n\n<div class="welcome">\n\t<hr />\n\t\n\t<p>Scelerisque vestibulum adipiscing fusce metus bibendum neque parturient sodales sem phasellus sed parturient sociis a aenean accumsan molestie a sociis non aliquam egestas. A tincidunt a nullam risus orci varius nullam vitae scelerisque a quam suspendisse a euismod consectetur duis senectus a a parturient et scelerisque parturient parturient parturient convallis. Massa tortor suspendisse fringilla a senectus placerat a mus et vestibulum velit a phasellus consectetur hac est eu.</p>\n\t\n\t<hr />\n\t\n\t<div class="clearfix"></div>\n\t\n\t<div class="container-fluid">\t\t\n\t\t<div class="pull-right text-right">\n\t\t\t<!-- Filter results by constituency -->\n\t\t\t<label for="filter-constituency">Filter constituency:&nbsp;</label>\n\t\t\t<select id="filter-constituency">\n\t\t\t\t<option value="showall" selected>Show All</option>\n'+(null!=(e=b.if.call(a,null!=a?a.models:a,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+'\t\t\t</select>\n\t\t</div>\n\t\t\n\t\t<table class="table table-hover">\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>Candidate Name</th>\n\t\t\t\t\t<th>Party</th>\n\t\t\t\t\t<th>Constituency</th>\n\t\t\t\t\t<th>Vote Count</th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t\t<!-- Results -->\n'+(null!=(e=b.if.call(a,null!=a?a.models:a,{name:"if",hash:{},fn:this.program(4,d,0),inverse:this.noop,data:d}))?e:"")+"\t\t\t</tbody>\n\t\t</table>\n\t</div>\n</div>"},useData:!0}),this.JST.VoteForm=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e=b.helperMissing,f=this.escapeExpression;return'<ol class="breadcrumb">\n\t<li><a href="/#">Kineo Technical Task</a></li>\n\t<li><a href="/#vote">Vote</a></li>\n\t<li class="active">Index</li>\n</ol>\n\n<div class="welcome">\t\n\t<hr />\n\t\n\t<p>Scelerisque vestibulum adipiscing fusce metus bibendum neque parturient sodales sem phasellus sed parturient sociis a aenean accumsan molestie a sociis non aliquam egestas. A tincidunt a nullam risus orci varius nullam vitae scelerisque a quam suspendisse a euismod consectetur duis senectus a a parturient et scelerisque parturient parturient parturient convallis. Massa tortor suspendisse fringilla a senectus placerat a mus et vestibulum velit a phasellus consectetur hac est eu.</p>\n\t\n\t<hr />\n\t\n\t<form id="form-voting" class="form-horizontal">\n\t\t<div class="form-group">\n\t\t\t<label for="first_name" class="col-sm-2 control-label">First Name:</label>\n\t\t\t<div class="col-sm-10">\n\t\t\t\t<input type="text" name="first_name" id="first_name" class="form-control required" />\n\t\t\t</div>\n\t\t</div>\n\t\t\n\t\t<div class="form-group">\n\t\t\t<label for="surname" class="col-sm-2 control-label">Surname:</label>\n\t\t\t<div class="col-sm-10">\n\t\t\t\t<input type="text" name="surname" id="surname" class="form-control required" />\n\t\t\t</div>\n\t\t</div>\n\t\t\n\t\t<div class="form-group">\n\t\t\t<label for="email" class="col-sm-2 control-label">Email:</label>\n\t\t\t<div class="col-sm-10">\n\t\t\t\t<input type="email" name="email" id="email" class="form-control required" />\n\t\t\t</div>\n\t\t</div>\n\t\t\n\t\t<div class="form-group">\n\t\t\t<label for="constituency" class="col-sm-2 control-label">Constituency:&nbsp;</label>\n\t\t\t<div class="col-sm-10">\n\t\t\t\t<select name="constituency" id="constituency">\n\t\t\t\t\t<option value="" disabled selected>Select a constituency</option>\n\t\t\t\t\t'+f((b.buildOptions||a&&a.buildOptions||e).call(a,null!=a?a.constituencyOptions:a,{name:"buildOptions",hash:{},data:d}))+'\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</div>\n\t\t\n\t\t<div class="form-group">\n\t\t\t<label class="col-sm-2 control-label">Are you going to vote?&nbsp;</label>\n\t\t\t<div class="col-sm-10">\n\t\t\t\t<input type="radio" name="voting" id="voting-yes" value="1" />&nbsp;<label for="voting-yes">Yes</label>\n\t\t\t\t&nbsp;<input type="radio" name="voting" id="voting-no" value="0" checked />&nbsp;<label for="voting-no">No</label>\n\t\t\t</div>\n\t\t</div>\n\t\t\n\t\t<div class="form-group hidden question_2">\n\t\t\t<!-- Hidden unless first question is answered yes - use Backbone events -->\n\t\t\t<label for="candidate" class="col-sm-2 control-label">Who are you going to vote for?&nbsp;</label>\n\n\t\t\t<div class="col-sm-10">\t\t\t\n\t\t\t\t<!-- Populated via AJAX with the candidates for the constituency specified above -->\n\t\t\t\t<select name="candidate" id="candidate">\n\t\t\t\t\t<option value="" disabled selected>Select a candidate</option>\n\t\t\t\t\t<!-- Prepend candidate options via AJAX if a constituency is selected -->\n\t\t\t\t\t'+f((b.buildOptions||a&&a.buildOptions||e).call(a,null!=a?a.candidateOptions:a,{name:"buildOptions",hash:{},data:d}))+'\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</div>\n\t\t\n\t\t<div class="form-group">\n\t\t\t<div class="col-sm-2">\n\t\t\t\t\n\t\t\t</div>\n\t\t\t<div class="col-sm-10">\n\t\t\t\t<button type="submit" class="btn btn-default">Submit</button>\n\t\t\t\t<p class="notice"></p>\n\t\t\t</div>\n\t\t</div>\n\t</form>\n</div>'},useData:!0}),this.JST.Welcome=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'<ol class="breadcrumb">\n\t<li><a href="/#">Kineo Technical Task</a></li>\n\t<li><a href="#">Home</a></li>\n\t<li class="active">Welcome</li>\n</ol>\n\n<div class="welcome">\n\t<h1>Welcome to the Kineo Technical Task!</h1>\n\t<p>Scelerisque vestibulum adipiscing fusce metus bibendum neque parturient sodales sem phasellus sed parturient sociis a aenean accumsan molestie a sociis non aliquam egestas. A tincidunt a nullam risus orci varius nullam vitae scelerisque a quam suspendisse a euismod consectetur duis senectus a a parturient et scelerisque parturient parturient parturient convallis. Massa tortor suspendisse fringilla a senectus placerat a mus et vestibulum velit a phasellus consectetur hac est eu.</p>\n</div>'},useData:!0}),function(a){"use strict";var b={bindHelpers:function(){for(var a in b.helpers)Handlebars.registerHelper(a,b.helpers[a])},helpers:{buildOptions:function(a){if(Array.isArray(a)){var b="";return a.forEach(function(a){b=b+'<option value="'+a.id+'">'+a.name+"</option>"}),new Handlebars.SafeString(b)}}}};a(function(){b.bindHelpers()})}(jQuery);var InterfaceHelpers={setMenuItemActive:function(a){$(".navbar-nav li").removeClass("active"),$(".navbar-nav ."+a).addClass("active")}},Validate={validateForm:function(a){var b=!0,c=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,a=$(a),d=a.find(".required");return d.each(function(){var a=$(this);""==a.val()?(a.addClass("error"),b=!1):a.removeClass("error"),a.is("input[type=email]")&&(address=a.val(),c.test(address)?a.removeClass("error"):(b=!1,a.addClass("error")))}),b}},app=app||{};!function(a){"use strict";var b=Backbone.Model.extend({defaults:{count:0}}),c=Backbone.Collection.extend({model:b,url:"/api/results",initialize:function(){this.fetch()},byConstituency:function(a){return _(this.filter(function(b){return b.get("constituency")==a}))}});app.resultsCollection=new c}(jQuery);var app=app||{};!function(a){"use strict";var b=Backbone.Model.extend({url:"/api/vote",defaults:{voting:!1},constituencyOptions:[],candidateOptions:[],getConstituencyOptions:function(b){var c=this;a.getJSON("/api/data/constituencies",function(a){c.constituencyOptions=a,b(a)})},getCandidateOptions:function(b,c){var d=this;a.getJSON("/api/data/candidates/"+b,function(a){d.candidateOptions=a,c(a)})}});app.voteModel=new b}(jQuery);var app=app||{};!function(a){"use strict";app.IndexView=Backbone.View.extend({template:JST.Welcome,initialize:function(){this.render()},render:function(){return this.$el.html(this.template),InterfaceHelpers.setMenuItemActive("home"),this}})}(jQuery);var app=app||{};!function(a){"use strict";app.ResultsView=Backbone.View.extend({template:JST.ResultsList,initialize:function(){this.collection=app.resultsCollection,this.listenTo(this.collection,"reset add remove change sort sync",this.render),this.collection.fetch()},render:function(a){return"undefined"!=typeof a&&(this.collection=a),this.$el.html(this.template(this.collection)),this.delegateEvents({"change select#filter-constituency":"filterByConstituency"}),InterfaceHelpers.setMenuItemActive("results"),this},filterByConstituency:function(){var b=a("select#filter-constituency").text();console.log(this.collection.byConstituency(b))}})}(jQuery);var app=app||{};!function(a){"use strict";app.VoteView=Backbone.View.extend({model:app.voteModel,template:JST.VoteForm,initialize:function(){this.render()},render:function(){var a=this,b=function(b){a.$el.html(a.template({constituencyOptions:b}))};return this.model.getConstituencyOptions(b),this.delegateEvents({'change input[name="voting"]':"displayVoteSelectToggle","change select#constituency":"injectCandidateOptions","submit form#form-voting":"submitVote"}),InterfaceHelpers.setMenuItemActive("vote"),this},displayVoteSelectToggle:function(){a(".question_2").toggleClass("hidden")},injectCandidateOptions:function(){var b=this,c=a("#constituency option:selected").val(),d=function(a){var c='<option value="" selected disabled>Select a candidate</option>';a.forEach(function(a){c=c+'<option value="'+a.id+'">'+a.name+" - "+a.party+"</option>"}),b.$el.find("select#candidate").html(c)};this.model.getCandidateOptions(c,d)},submitVote:function(a){return a.preventDefault(),!!Validate.validateForm(this.$el.find("form"))&&(this.model.set({email:this.$el.find('input[name="email"]').val(),first_name:this.$el.find('input[name="first_name"]').val(),surname:this.$el.find('input[name="surname"]').val(),constituency:this.$el.find('select[name="constituency"]').val(),voting:this.$el.find('input[name="voting"]:checked').val(),candidate:this.$el.find('select[name="candidate"]').val()}),void this.model.save(null,{success:function(a,b){app.Element.find("button[type=submit]").prop("disabled",!0),app.Element.find("form .notice").html("Thank you your vote has been counted!")},error:function(a,b){var c=JSON.parse(b.responseText);app.Element.find("form .notice").html(c.message)}}))}})}(jQuery);var app=app||{};$(function(){"use strict";app.Element=$("#app");var a=Backbone.Router.extend({root:"/",routes:{"":"indexView",vote:"voteView",results:"resultsView","*notFound":"indexView"},showView:function(a){app.Element.html(a.render().el)},indexView:function(){app.indexView=new app.IndexView,this.showView(app.indexView)},resultsView:function(){app.resultsView=new app.ResultsView,this.showView(app.resultsView)},voteView:function(){app.voteView=new app.VoteView,this.showView(app.voteView)}});app.router=new a,Backbone.history.start()});
//# sourceMappingURL=app.min.js.map